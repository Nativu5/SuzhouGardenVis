# 苏州园林数据可视化项目

## 目录约定

项目核心需求：[docs/项目需求.md](docs/项目需求.md)
项目实现方案：[docs/实现方案.md](docs/实现方案.md)

- ./dataset: 苏州园林数据和图片
- ./archived: 旧数据，禁止使用
- ./archived/VIS: 旧版可视化项目(A)，带有 高德 API 可供参考（索引文档：docs/OLD_VIS_INDEX.md）
- ./archived/web: 旧版可视化项目(B)，可供参考。
- ./docs: 项目相关文档
- DEPLOYMENT.md: Cloudflare 部署指南

唯一的真实数据源头：public/dataset/SuzhouGardenListFull.csv 和 public/dataset/images 中的图片（以园林名称命名的文件夹）。
当前目录下已经使用 `npm create vite@latest -- --template vue-ts` 创建好了 Vue3 + TypeScript + Vite 项目骨架。

## 开发指引

- 在所有开发过程中，必须严格遵循"项目核心需求"和"项目实现方案"中的各项规定，确保最终交付物符合预期要求。
- 任何 "项目核心需求" 和 "项目实现方案" 中表述不清、有歧义或存在冲突的地方，必须及时要求用户确认，避免任何理解偏差导致的开发错误。
- 每次修改完成后，都需要对 AGENTS.md 进行更新，记录当前的开发进度和下一步计划。
- 开发中不需要考虑节省 Token，优先保证输出内容的完整性和准确性。

## 环境提示

- 在 zsh 中使用 "setp" 这个命令可以设置代理环境变量（在 .zshrc 中已经配置好）。
- 当前目录中可以使用 uv 管理当前 Python 版本和虚拟环境(.venv/bin/activate)。
- 当前环境中已经安装好 npm，如需启动服务器、运行构建或安装新 Package，必须要求用户协助。
- 由于开发服务器运行可能导致终端阻塞，如有测试需求，请直接要求用户自行启动测试。

---

## 项目里程碑规划

### 里程碑 0：前期准备与环境配置 ✅
**目标**：完成开发环境配置，确保项目基础设施就绪

**任务清单**：
- [x] 初始化 Vue3 + Vite + TypeScript 项目骨架（已完成）
- [x] 安装核心依赖：Tailwind CSS、Pinia、ECharts、PapaParse、@amap/amap-jsapi-loader
- [x] 配置 Tailwind CSS（包括配置文件和样式入口）
- [x] 配置环境变量（创建 .env 文件，添加 VITE_AMAP_KEY）
- [x] 配置路径别名（tsconfig.json 和 vite.config.ts 中设置 @ 别名指向 src）
- [x] 验证开发服务器正常启动

**交付物**：
- ✅ 完整的 package.json 依赖清单
- ✅ 可运行的基础开发环境
- ✅ Tailwind CSS 配置完成（tailwind.config.js + postcss.config.js）
- ✅ 环境变量配置模板（.env + .env.example）
- ✅ 路径别名配置（@ -> src）

---

### 里程碑 1：数据层与类型系统 ✅
**目标**：建立数据加载、解析和类型定义体系，确保数据流通畅

**任务清单**：
- [x] 定义 TypeScript 类型接口（GardenData、Filters、NarrativeScene 等）
- [x] 实现 CSV 数据加载服务（services/dataLoader.ts）
- [x] 实现数据清洗与字段映射逻辑
  - 处理面积数值化
  - 处理文保单位级别空值（归为"未定级"）
  - 处理世界遗产空值（视为 FALSE）
  - 实现面积区间分箱逻辑
- [x] 实现派生字段计算（建造年代分类、面积区间等）
- [x] 搭建 Pinia Store 基础架构（store/index.ts、store/gardenStore.ts）
- [x] 在 Store 中实现数据状态管理
  - rawData（原始数据）
  - filteredData（过滤后数据，computed）
  - filters（筛选条件）
  - viewMode（概览/探索模式）
  - overviewNarrative（当前叙事场景）
  - selectedGarden（选中园林）
- [x] 实现统一过滤逻辑（Store getter）
- [x] 编写数据加载测试代码，验证数据正确加载

**交付物**：
- ✅ 完整的 TypeScript 类型定义文件 (src/types/index.ts)
- ✅ 可工作的数据加载与清洗模块 (src/services/dataLoader.ts)
- ✅ Pinia Store 状态管理架构 (src/stores/gardenStore.ts)
- ✅ 数据验证通过（108 条记录正确加载）
- ✅ 数据测试页面可正常显示统计信息

---

### 里程碑 2：基础布局与 UI 框架 ✅
**目标**：实现三栏式布局框架，建立模式切换机制

**任务清单**：
- [x] 设计并实现顶部导航栏组件（HeaderNav.vue）
  - 项目标题
  - 模式切换按钮（概览/探索）
- [x] 实现三栏式布局容器（MainLayout.vue）
  - 左侧操作区（宽度 320px）
  - 中间主视图（flex-1）
  - 右侧详情区（宽度 384px，仅探索模式显示）
- [x] 实现左侧操作区框架（LeftPanel.vue）
  - 概览模式：叙事场景选择器 + 场景筛选器容器
  - 探索模式：搜索框 + 多维筛选器容器
- [x] 实现中间主视图容器（MainView.vue）
  - 概览模式：图表网格容器
  - 探索模式：地图容器
- [x] 实现右侧详情区框架（RightPanel.vue，仅探索模式）
  - 空状态提示
  - 区域统计视图
  - 园林详情视图
- [x] 实现模式切换逻辑
  - Store 中的 viewMode 状态管理
  - 切换时保留筛选条件
  - UI 响应模式切换
- [x] 实现响应式布局样式（桌面端优先）
- [x] 修复类型系统（将 enum 改为 type 联合类型以兼容 erasableSyntaxOnly）

**交付物**：
- ✅ 完整的三栏式布局框架
- ✅ 可切换的概览/探索模式
- ✅ 基础 UI 组件库结构（HeaderNav、LeftPanel、MainView、RightPanel、MainLayout）
- ✅ 模式切换动画与状态管理
- ✅ 构建验证通过

---

### 里程碑 3：概览模式 - 叙事场景与图表 ✅
**目标**：实现概览模式的四个叙事场景及其对应的图表与表格

**任务清单**：

#### 3.1 指标卡与 KPI 组件
- [x] 设计并实现 KPI 指标卡组件（MetricCard.vue）
- [x] 实现核心指标计算逻辑（园林总数、开放率、世界遗产数、平均面积等）
- [x] 在概览模式左侧展示指标摘要

#### 3.2 叙事场景选择器
- [x] 实现叙事场景下拉选择组件（NarrativeSelector.vue）
- [x] 定义四个叙事场景配置
  - 空间集中与遗产核心
  - 历史谱系与认定节奏
  - 开放可达与权属/用途
  - 规模结构与资源配置
- [x] 实现场景切换逻辑

#### 3.3 通用图表组件封装
- [x] 封装 ECharts 基础容器组件（BaseChart.vue）
- [x] 实现柱状图组件（BarChart.vue）
- [x] 实现分层柱状图组件（StackedBarChart.vue）
- [x] 实现桑基图组件（SankeyChart.vue）
- [x] 实现直方图组件（HistogramChart.vue）

#### 3.4 场景 1：空间集中与遗产核心
- [x] 实现区县×文保单位级别分层柱状图
- [x] 实现区县园林数量/总面积柱状图
- [x] 实现世界遗产在区县分布柱状图
- [x] 实现世界遗产园林清单表格组件
- [x] 集成为完整场景视图组件（NarrativeScene1.vue）

#### 3.5 场景 2：历史谱系与认定节奏
- [x] 实现建设时期数量柱状图
- [x] 实现建造年代×文保单位级别分层柱状图
- [x] 实现公布批次×建造年代分层柱状图
- [x] 实现早期年代园林清单表格组件
- [x] 集成为完整场景视图组件（NarrativeScene2.vue）

#### 3.6 场景 3：开放可达与权属/用途
- [x] 实现权属性质→开放情况桑基图
- [x] 实现当前用途×开放情况分层柱状图
- [x] 实现区县×开放情况分层柱状图
- [x] 实现未开放园林清单表格组件
- [x] 集成为完整场景视图组件（NarrativeScene3.vue）

#### 3.7 场景 4：规模结构与资源配置
- [x] 实现面积区间直方图（按开放情况分层）
- [x] 实现区县平均/总面积柱状图
- [x] 实现建造年代平均面积柱状图
- [x] 实现面积 Top10 园林表格组件
- [x] 集成为完整场景视图组件（NarrativeScene4.vue）

#### 3.8 视觉编码统一化
- [x] 定义统一的配色方案（区县、文保级别、开放情况等）
- [x] 实现图表主题配置（theme.ts）
- [x] 应用统一视觉编码到所有图表

**交付物**：
- ✅ 完整的概览模式四个叙事场景
- ✅ 所有必需的图表组件（BaseChart、BarChart、StackedBarChart、SankeyChart、HistogramChart）
- ✅ 场景切换与叙事选择功能正常
- ✅ 统一的视觉编码体系（theme.ts）
- ✅ KPI 指标卡展示
- ✅ 构建验证通过

---

### 里程碑 4：探索模式 - 地图集成 ✅
**目标**：集成高德地图，实现行政区边界展示和园林点位标注

**任务清单**：

#### 4.1 地图基础设施
- [x] 实现地图加载服务（services/mapLoader.ts）
- [x] 使用 @amap/amap-jsapi-loader 动态加载 AMap JS API
- [x] 实现地图容器组件（MapView.vue）
- [x] 初始化地图实例，设置苏州市为中心
- [x] 配置地图控件（缩放、比例尺等）

#### 4.2 行政区边界展示
- [x] 使用 DistrictLayer 或 DistrictSearch 获取苏州市及区县边界
- [x] 实现行政区 polygon 渲染
- [x] 实现区县分级着色（基于园林数量或面积）
- [x] 实现行政区点击交互
- [x] 从 archived/VIS/suzhou_districts.json 复制并转换行政区边界数据到项目目录

#### 4.3 园林点位展示
- [x] 基于经纬度创建 Marker 标注
- [x] 实现自定义 Marker 样式（根据文保级别、开放情况着色）
- [x] 集成 MarkerClusterer 实现点位聚合
- [x] 实现聚合/散点模式切换
- [x] 实现点位点击事件处理

#### 4.4 地图信息弹窗
- [x] 实现点位点击弹窗（使用 AMap.InfoWindow）
- [x] 显示园林基础信息（名称、开放情况、地址、面积等）
- [x] 显示区县统计信息（区县名称、园林数量）

#### 4.5 地图与筛选联动
- [x] 监听 Store 中的 filteredData 变化
- [x] 动态更新地图点位集合
- [x] 实现地图数据联动（筛选更新地图显示）

**交付物**：
- ✅ 可工作的高德地图集成
- ✅ 行政区边界与园林点位正确展示
- ✅ 地图交互与联动功能正常
- ✅ 无 TypeScript 错误

---

### 里程碑 5：搜索与筛选功能 ✅
**目标**：实现全局筛选系统，支持多维度组合筛选

**任务清单**：

#### 5.1 筛选组件开发
- [x] 实现下拉选择筛选器（SelectFilter.vue）
- [x] 实现多选筛选器（MultiSelectFilter.vue）
- [x] 实现范围筛选器（RangeFilter.vue，用于面积区间）
- [x] 实现布尔筛选器（BooleanFilter.vue，用于世界遗产）
- [x] 搜索框已在里程碑 2 中完成（LeftPanel.vue）

#### 5.2 探索模式筛选器集成
- [x] 集成搜索框（按名称搜索）
- [x] 集成区县筛选器
- [x] 集成建造年代筛选器
- [x] 集成年代分类筛选器
- [x] 集成开放情况筛选器
- [x] 集成文保单位级别筛选器
- [x] 集成权属性质筛选器
- [x] 集成世界遗产筛选器
- [x] 集成当前用途筛选器
- [x] 集成公布批次筛选器
- [x] 集成面积区间筛选器
- [x] 实现清空筛选按钮

#### 5.3 筛选逻辑实现
- [x] 在 Store 中实现多维度组合筛选逻辑（已在里程碑 1 完成）
- [x] 实现搜索逻辑（名称模糊匹配，已在里程碑 1 完成）
- [x] 实现筛选结果缓存与优化（通过 computed 实现）
- [x] 实现筛选条件持久化（模式切换时保留，已在 Store 实现）

#### 5.4 筛选反馈与统计
- [x] 显示筛选结果数量
- [x] 显示当前生效的筛选标签
- [x] 实现快速清除单个筛选条件
- [x] 实现清空全部筛选条件

**交付物**：
- ✅ 完整的筛选组件库（MultiSelectFilter、SelectFilter、BooleanFilter、RangeFilter）
- ✅ 筛选器集成组件（ExploreFilters）
- ✅ 筛选标签组件（FilterTags）
- ✅ 多维度组合筛选功能正常
- ✅ 搜索功能正常（仅探索模式）
- ✅ 构建验证通过

---

### 里程碑 6：详情面板与信息展示 ✅
**目标**：实现探索模式的详情展示，支持园林详情和区域统计

**任务清单**：

#### 6.1 园林详情卡片
- [x] 实现园林详情卡片组件（集成到 RightPanel.vue）
- [x] 展示完整字段信息（名称、区县、地址、建造年代、面积、文保级别、权属性质、管理单位、保护状况、开放情况、当前用途、描述）
- [x] 实现图片展示功能
  - 按名称匹配 dataset/images 中的图片文件夹
  - 支持图片轮播或网格展示
  - 无图片时显示占位符
- [x] 实现详情卡片样式设计

#### 6.2 区域统计视图
- [x] 实现区域统计组件（集成到 RightPanel.vue）
- [x] 展示选中区县的园林列表（简表：名称、开放情况、权属性质）
- [x] 展示区域统计指标（总数、开放率、平均面积等）
- [x] 实现区域内园林点击跳转到详情

#### 6.3 右侧详情区状态管理
- [x] 实现详情区状态切换（空状态/区域统计/园林详情）
- [x] 监听地图点击事件，更新详情区内容
- [x] 实现详情区关闭按钮（返回空状态）

#### 6.4 图片加载与优化
- [x] 实现图片懒加载
- [x] 实现图片加载失败处理
- [x] 优化图片展示性能

**交付物**：
- ✅ 完整的详情展示功能
- ✅ 图片展示正常（按名称匹配）
- ✅ 区域统计与园林详情切换正常
- ✅ 构建验证通过

---

### 里程碑 7：交互优化与视觉完善
**目标**：优化用户体验，完善视觉设计，确保交互流畅，并补充新的可视化需求

**任务清单**：

#### 7.1 新增功能：区域统计雷达图与概览增强
- [x] 加载行政区划数据（SuzhouDistricts.csv，含人口与面积）并注入 Store
- [x] 实现雷达图组件（RadarChart.vue）
- [x] 计算可访问指数（基于人口与开放园林数）
- [x] 在右侧详情面板集成雷达图（展示人口、面积、园林数量、开放率、可访问指数）
- [x] 增强概览模式场景 1：将"区县园林数量"图表升级为"园林密度对比"（含每平方公里数量）
- [x] 增强概览模式场景 3：新增"区县人均开放资源"图表（含每万人开放园林数量）

#### 7.2 交互优化
- [x] 实现地图高亮联动（详情面板 → 地图）
- [ ] 实现图表悬停提示优化（tooltip 内容丰富化）
- [x] 实现加载状态提示（loading spinner）
- [x] 实现错误状态提示（数据加载失败、地图加载失败等）
- [ ] 优化筛选器交互体验（下拉动画、选中反馈等）
- [ ] 优化模式切换动画

#### 7.3 视觉设计完善
- [x] 设计统一的配色方案
- [x] 设计图表样式（网格、坐标轴、标签等）
- [x] 设计卡片与面板阴影、边框样式
- [x] 设计按钮与交互元素样式
- [x] 调整字体大小与行高，确保可读性

#### 7.4 性能优化
- [x] 优化图表重绘性能
- [x] 优化地图 Marker 渲染性能（实现聚合/散点模式切换）
- [ ] 优化打包体积


**交付物**：
- ✅ 统一的视觉风格（配色方案、图表样式、组件样式）
- ✅ 地图 Marker 渲染性能优化（聚合模式）
- ✅ 加载与错误状态提示
- ✅ 区域统计雷达图与概览增强（行政区划数据、雷达图、园林密度、人均开放资源）
- 交互体验优化（高亮联动、悬停提示、动画优化）
- 图表重绘性能优化与打包体积优化

---

## 当前状态

**已完成**：
- 里程碑 0 - 前期准备与环境配置 ✅
- 里程碑 1 - 数据层与类型系统 ✅
- 里程碑 2 - 基础布局与 UI 框架 ✅
- 里程碑 3 - 概览模式叙事场景与图表 ✅
- 里程碑 4 - 探索模式地图集成 ✅
- 里程碑 5 - 搜索与筛选功能 ✅
- 里程碑 6 - 详情面板与信息展示 ✅
- 里程碑 7.1 - 区域统计雷达图与概览增强 ✅
- 里程碑 7.3 - 视觉设计完善 ✅
- 里程碑 7.4 - 地图性能优化 ✅（部分）

**当前进度**：里程碑 7 部分完成（雷达图与概览增强已完成）
**下一步**：里程碑 7 剩余任务 - 交互优化（高亮联动、tooltip优化、动画优化）、图表重绘性能优化、打包体积优化

### 已完成工作简要总结

**里程碑 0：**
已完成 Vue3+Vite+TS 项目初始化，集成 Tailwind CSS、Pinia、ECharts、AMap 和 PapaParse 等核心依赖。配置了环境变量、路径别名及 Tailwind 主题色，确保开发环境与基础设施就绪。

**里程碑 1：**
建立了完整的 TypeScript 类型系统（含 GardenData、Filters 等），实现了 CSV 数据加载、清洗与派生字段计算服务。搭建了 Pinia Store 管理数据状态、筛选逻辑与视图模式，并成功验证了 108 条园林数据的正确加载与统计指标计算。

**里程碑 2：**
实现了完整的三栏式响应式布局框架，包括顶部导航栏（HeaderNav）、左侧操作区（LeftPanel）、中间主视图（MainView）、右侧详情区（RightPanel）和主布局容器（MainLayout）。成功实现了概览/探索模式的切换机制，包括状态管理、UI响应和切换动画。修复了类型系统问题（将enum改为type联合类型），构建验证通过。左侧面板根据模式显示不同内容（概览模式：叙事场景选择器；探索模式：搜索框），右侧详情区仅在探索模式显示并带有平滑过渡动画。

**里程碑 3：**
完成概览模式的全部四个叙事场景实现。建立了统一的视觉编码体系（theme.ts），定义了区县、文保级别、开放情况等维度的配色方案。实现了完整的图表组件库，包括BaseChart（ECharts基础容器）、BarChart（柱状图）、StackedBarChart（分层柱状图）、SankeyChart（桑基图）、HistogramChart（直方图）。实现了四个叙事场景组件：
- 场景1（空间集中与遗产核心）：展示区县×文保级别分布、区县园林数量/总面积、世界遗产分布及清单
- 场景2（历史谱系与认定节奏）：展示建设时期分布、建造年代×文保级别、公布批次×建造年代及早期园林清单
- 场景3（开放可达与权属/用途）：展示权属→开放桑基图、当前用途×开放情况、区县×开放情况及未开放园林清单
- 场景4（规模结构与资源配置）：展示面积区间分布、区县平均/总面积、建造年代平均面积及面积Top10清单
实现了MetricCard组件和NarrativeSelector组件，左侧面板展示整体统计指标。所有图表支持响应式布局、交互联动和统一主题。构建验证通过，无TypeScript错误。

**里程碑 4：**
完成探索模式的高德地图集成，实现了地图的完整交互功能。创建了地图加载服务（mapLoader.ts），使用 @amap/amap-jsapi-loader 动态加载高德地图 JS API 2.0，配置了 API Key 和安全密钥。实现了地图容器组件（MapView.vue），包含地图初始化、控件配置（比例尺、工具条）、加载状态管理和错误处理。成功实现了行政区边界展示功能：
- 从 archived/VIS 复制并加载 GeoJSON 行政区边界数据
- 实现区县分级着色（基于园林数量的渐变配色）
- 实现区县点击交互和鼠标悬停效果
- 显示区县信息弹窗（区县名称、园林数量）
实现了园林点位标注功能：
- 创建自定义 Marker 样式（根据文保级别着色，使用 theme.ts 配色）
- 集成 MarkerClusterer 实现点位聚合
- 实现聚合/散点模式切换（带切换按钮）
- 点击 Marker 显示园林信息弹窗（名称、区县、地址、文保级别、开放情况、建造年代、面积）
实现了地图与 Store 数据的完整联动：
- 监听 filteredData 变化，动态更新地图点位
- 根据聚合模式自动切换渲染方式
- 组件卸载时正确清理资源（Markers、InfoWindow、地图实例）
将 MapView 组件集成到 MainView 探索模式视图中，替换占位符。无 TypeScript 错误，待构建验证。

**里程碑 5：**
完成探索模式的全局筛选系统，实现了多维度组合筛选功能。创建了完整的筛选器组件库：
- MultiSelectFilter.vue：多选下拉筛选器，支持全选/清空操作，带有选中数量提示和点击外部关闭功能
- SelectFilter.vue：单选下拉筛选器，用于简单的单项选择
- BooleanFilter.vue：三态布尔筛选器（全部/是/否），用于世界遗产筛选
- RangeFilter.vue：数值范围筛选器，支持最小值/最大值输入（为后续面积范围筛选预留）
实现了筛选器集成组件（ExploreFilters.vue），包含所有探索模式所需的筛选维度：
- 基础筛选：区县、开放情况、文保单位级别
- 权属与用途：权属性质、当前用途、世界遗产
- 时间维度：年代分类、建造年代、公布批次
- 规模筛选：面积区间
实现了筛选标签组件（FilterTags.vue），用于展示当前生效的筛选条件：
- 显示所有生效筛选条件的标签（带分类标签和值）
- 支持快速清除单个筛选条件
- 提供清空全部筛选按钮
更新了 LeftPanel 组件，完整集成筛选功能：
- 探索模式下展示搜索框、筛选结果统计、筛选标签、多维筛选器和清空按钮
- 优化布局结构，筛选器区域支持滚动，固定搜索框和清空按钮位置
- 筛选结果实时显示，筛选条件持久化（模式切换时保留）
筛选逻辑完全基于 Store 中的 computed 属性实现，无需额外缓存优化。所有筛选器与地图、图表完全联动。构建验证通过，无 TypeScript 错误。

**里程碑 6：**
完成探索模式的详情面板与信息展示功能，实现了园林详情卡片、区域统计视图和图片展示。创建了图片展示组件（GardenImageGallery.vue）：
- 自动从 `/dataset/images/园林名称/` 文件夹加载图片（尝试加载 01.jpg 至 10.jpg）
- 支持多图轮播展示，包含左右切换箭头、图片指示器和计数器
- 实现图片懒加载和错误处理
- 无图片时显示占位符（图标 + 提示文字）
更新了 RightPanel 组件，完善详情展示功能：
- 集成 GardenImageGallery 组件替换图片占位符
- 园林详情视图展示完整字段信息（名称、区县、地址、建造年代、面积、文保级别、权属性质、管理单位、保护状况、开放情况、当前用途、描述、世界遗产标识）
- 区域统计视图展示选中区县的园林列表和统计指标
  - **智能统计显示**：无筛选条件时显示"园林数量"和"开放数量"两个指标；有筛选条件时只显示"满足筛选条件的园林"单一计数器，避免统计指标与筛选结果产生歧义
  - **多维度 Badge 展示**：园林列表项使用 badge 形式展示四个关键维度：开放情况（绿色/灰色）、保护等级（红/橙/黄/蓝色阶，对应全国重点/省级/市级/区级）、权属性质（紫色）、当前用途（青色），使用 flex-wrap 自适应换行布局
- 区域内园林点击可跳转到园林详情视图
- 实现详情区状态切换（空状态/区域统计/园林详情）和关闭按钮
更新了 MapView 组件，实现地图与详情区的交互联动：
- 点击地图上的区县边界时，调用 `gardenStore.selectDistrict()` 显示区域统计
- 点击园林点位（散点或聚合点）时，调用 `gardenStore.selectGarden()` 显示园林详情
- 地图点击事件与右侧详情区完全联动，实现信息流畅切换
- **智能区域遮罩显示**：实现了行政区遮罩与筛选器的联动
  - 当筛选器中选择了特定区县时，地图上只显示被选中区县的行政区遮罩
  - 当没有区县筛选条件时，显示所有区县的行政区遮罩
  - 遮罩显示开关关闭时，不显示任何遮罩
  - 监听区县筛选条件变化，实时动态更新遮罩显示
Store 状态管理已在里程碑 1 中完成（`selectedGarden` 和 `selectedDistrict` 状态及相关方法），本里程碑重点实现了 UI 展示和交互联动。构建验证通过，无 TypeScript 错误。部分园林可能不存在图片，此时仅展示文本信息和占位符。

**里程碑 7：**（部分完成）
完成了区域统计雷达图、概览增强和地图高亮联动功能：
- **行政区划数据加载**：扩展类型系统（DistrictData、DistrictStatistics），实现 SuzhouDistricts.csv 数据加载服务（loadDistrictData），在 Store 中并行加载园林数据和区划数据（9条区县数据：土地面积、常住人口）
- **雷达图组件**：创建 RadarChart.vue 组件，展示5个维度（人口、面积、园林数量、开放率、可访问指数），实现数据归一化到 0-100 范围，自定义 tooltip 展示完整原始数据。修复筛选显示问题：雷达图始终显示并基于筛选结果动态计算，有筛选条件时显示"（基于筛选结果）"提示
- **可访问指数计算**：基于人均开放园林数（个/万人）计算，公式为 openGardenPerCapita * 100，结果限制在 0-100 范围内
- **右侧详情面板集成**：在 RightPanel.vue 的区域统计视图中集成雷达图，展示区域综合指标
- **概览场景1增强**：在 NarrativeScene1.vue 中添加"园林密度对比"图表（个/km²），替换原有的"各区县园林数量"图表，基于 districtStatistics 计算密度数据
- **概览场景3增强**：在 NarrativeScene3.vue 中添加"区县人均开放资源"图表（个/万人），展示每万人口开放园林数量，帮助识别公共资源配置的公平性
- **地图高亮联动**：实现详情面板 → 地图的双向联动，包括：
  - 元素引用映射：districtPolygonMap（区县边界数组映射）、gardenMarkerMap（园林点位映射）
  - 区县高亮：描边加粗（4px）、颜色变蓝（#2563EB）、透明度提升（0.75），自动缩放到区县视野（padding 100px，动画 500ms）
  - 园林高亮：圆点放大（18px）、蓝色边框（3px）、脉冲动画、发光阴影，自动缩放到 zoom 16 并居中（动画 500ms）
  - Watch 监听：监听 selectedDistrict 和 selectedGarden 变化，自动高亮并缩放视野
  - 聚合模式提示：在聚合模式下选中园林时，控制台提示用户切换到散点模式
  - 清理机制：组件卸载时清空所有映射和高亮状态
- **Bug 修复**：修复了探索模式右侧详情面板中文保等级 Badge 着色异常的问题（将 '全国重点' 修正为 '全国' 以匹配数据源）。
- **性能优化**：
  - 优化了 MapView 组件的性能，移除了 `districtPolygonMap` 和 `gardenMarkerMap` 的响应式代理，避免了 Vue 深度代理 AMap 实例导致的卡顿；优化了 `highlightGarden` 逻辑，避免重复设置样式。
  - 优化了 GardenImageGallery 组件的图片加载策略，改为优先加载第一张图片，成功后再异步加载后续图片，避免一次性发起大量 404 请求阻塞主线程；修复了组件挂载时重复触发加载的 Bug。
- **交互优化**：
  - 优化了地图聚焦逻辑，点击地图上的园林散点时不再自动缩放和移动视野（避免屏幕抖动），仅在从右侧列表点击园林时才进行聚焦；点击行政区或聚合点时保持聚焦行为。
  - 修复了聚合模式下点击园林无法高亮的问题。重构了 `highlightGarden` 逻辑，不再依赖 `gardenMarkerMap`，而是动态创建高亮 Marker，确保在聚合模式下也能正确显示高亮效果。
  - 修复了切换聚合/散点模式或筛选数据时高亮丢失的问题。在 `updateGardenMarkers` 中添加了重新应用高亮的逻辑，并确保不触发不必要的视野跳转。
  - 修复了聚合模式下点击聚合点（蓝色圆圈）无反应的问题。在 `markerCluster` 的点击事件中添加了对聚合点的处理逻辑：计算聚合点包含的所有点的边界（Bounds），并自动缩放地图以适配视野（`setBounds`），如果点位重合则直接放大。
所有功能构建验证通过（4.36s），无 TypeScript 错误。视觉设计完善、地图性能优化、加载/错误状态提示等已在前期里程碑完成。剩余待实现：图表 tooltip 优化、筛选器动画、模式切换动画、图表重绘性能优化、打包体积优化。
