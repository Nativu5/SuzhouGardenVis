# 苏州园林数据可视化 实现方案

## 1. 目标与范围
- 面向园林保护研究者与游客，提供“数据大盘 + 地图 + 列表/详情”的单页应用（桌面端）。
- 数据来源固定为 `dataset/SuzhouGardenListFull.csv`，不接入后端。
- 地图集成高德地图（AMap JS API），展示苏州市行政区与园林点位，并与图表联动。

## 2. 技术选型
- 框架：Vue 3 + Vite + TypeScript
- 样式：Tailwind CSS（支持三栏式布局与可视化面板样式）
- 图表：ECharts（或 D3，优先 ECharts 加快落地）
- 地图：`@amap/amap-jsapi-loader` + AMap JS API（含 DistrictSearch / DistrictLayer / MarkerClusterer）
- 数据解析：PapaParse（CSV 解析）
- 状态管理：Pinia（统一筛选条件与联动状态）

## 3. 项目结构（建议）
- `web/` 作为前端根目录
- `web/src/`
- `web/src/components/`：图表、筛选、列表、详情、指标卡
- `web/src/views/`：主页面（DashboardView）
- `web/src/services/`：数据加载与清洗、地图加载
- `web/src/store/`：Pinia 状态（filters、selection、metrics）
- `web/public/data/`：`SuzhouGardenListFull.csv`（构建时拷贝或软链接）

## 4. 数据处理方案
### 4.1 解析与清洗
- 使用 PapaParse 读取 CSV，统一字段名映射为英文 key。
- 字段转换：
  - `经度/纬度` → number（无效值过滤）
  - `面积（㎡）` → number（缺失值设为 0）
  - `世界遗产` → boolean
- 派生字段：
  - `isOpen`：`开放情况 === "开放"`
  - `eraGroup`：建造年代按“唐宋/元/明/清/近代/未知”分组（可配置）

### 4.2 数据分组与指标
- 总数、开放数、世界遗产数、总面积、均面积
- 图表分组：
  - 区县分布
  - 建造年代分布
  - 文保单位级别占比
  - 权属性质/开放情况/当前用途分布

## 5. 页面与布局（桌面端）
- 左侧：筛选区（搜索 + 多维筛选 + 统计概要）
- 中间：地图主视图（行政区 + 点位 + 交互弹窗）
- 右侧：详情区（选中园林详情 + 图片/描述）
- 顶部：标题与全局指标卡（可占满中间主视图上方）

## 6. 核心功能实现
### 6.1 数据大盘
- 指标卡组件：展示核心 KPI（总数/开放/遗产/面积）。
- 图表组件：ECharts 封装统一 props（数据、颜色、hover 回调）。
- 图表与筛选联动：点击图表维度触发过滤条件，更新地图与列表。

### 6.2 地图可视化（AMap）
- 使用 `@amap/amap-jsapi-loader` 动态加载 JS API。
- 行政区边界：
  - 优先使用 `DistrictLayer` 展示苏州市及区县边界。
  - 或使用 `DistrictSearch` 获取区县 polygon 数据并渲染。
- 点位展示：
  - 基于经纬度创建 Marker。
  - 数据量可使用 `MarkerClusterer` 开启聚合/散点切换。
- 交互：
  - 点击点位 → 触发详情面板与高亮。
  - 过滤条件变化 → 更新点位集合与聚合。

### 6.3 信息展示
- 列表/卡片：名称、区县、开放情况、简介摘要。
- 详情面板：描述、管理单位、文保级别、面积、地址。
- 图片支持：若 `dataset/images` 有对应图片，则按名称匹配加载。

### 6.4 搜索与筛选
- 搜索：名称/地址关键词匹配（前端模糊搜索）。
- 筛选：区县、建造年代、开放情况、文保级别、权属性质。
- 清空筛选：恢复全量数据。

## 7. 状态管理与联动
- Pinia store 持有：
  - `filters`：当前筛选条件
  - `selectedGarden`：当前选中的园林
  - `filteredData`：计算后的数据集
- 统一过滤逻辑：在 store 的 getter 中处理，图表/地图/列表共用。

## 8. 配置与部署
- AMap Key 通过 `.env` 注入（如 `VITE_AMAP_KEY`）。
- 构建产物为静态文件，可部署至任意静态托管服务。

## 9. 实施步骤（里程碑）
1. 初始化前端工程（Vue 3 + Vite + Tailwind + TS）
2. 数据加载与清洗模块（CSV 解析 + 字段映射）
3. 三栏式布局与基础 UI 框架
4. 指标卡与图表组件（ECharts）
5. 地图集成（行政区边界 + 点位）
6. 筛选/搜索/联动功能
7. 详情面板与图片支持
8. 交互优化与视觉完善

## 10. 验收映射
- 指标卡与图表正常渲染并反映 CSV 数据。
- 地图展示苏州市行政区与园林点位，可点击交互。
- 搜索/筛选/点选正常工作，地图与图表联动。
- 无需后端服务，静态部署可运行。
